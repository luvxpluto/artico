!function (e, r) { YayCurrency_Callback = r.YayCurrency_Callback || {}, yay_currency_data_args = { common_data_args: { yayCurrencySymbolWrapper: "span.woocommerce-Price-currencySymbol", yayCurrencySwitcher: ".yay-currency-single-page-switcher", yayCurrencyWidget: ".yay-currency-widget-switcher", yayCurrencyBlock: ".yay-currency-block-switcher", yayCurrencyCartContents: "a.cart-contents" }, converter_args: { converterWrapper: ".yay-currency-converter-container", converterAmount: ".yay-currency-converter-amount", converterFrom: ".yay-currency-converter-from-currency", converterTo: ".yay-currency-converter-to-currency", converterResultWrapper: ".yay-currency-converter-result-wrapper", converterResultAmount: ".yay-currency-converter-amount-value", converterResultFrom: ".yay-currency-converter-from-currency-code", converterResultValue: ".yay-currency-converter-result-value", converterResultTo: ".yay-currency-converter-to-currency-code" }, switcher_data_args: { activeClass: "active", upwardsClass: "upwards", openClass: "open", selectedClass: "selected", currencySwitcher: ".yay-currency-switcher", currencyFlag: ".yay-currency-flag", currencySelectedFlag: ".yay-currency-flag.selected", customLoader: ".yay-currency-custom-loader", customOption: ".yay-currency-custom-options", customArrow: ".yay-currency-custom-arrow", customOptionArrow: ".yay-currency-custom-option-row", customOptionArrowSelected: ".yay-currency-custom-option-row.selected", selectTrigger: ".yay-currency-custom-select__trigger", selectWrapper: ".yay-currency-custom-select-wrapper", customSelect: ".yay-currency-custom-select", selectedOption: ".yay-currency-custom-select__trigger .yay-currency-selected-option" }, blocks_data_args: { checkout: ".wp-block-woocommerce-checkout[data-block-name='woocommerce/checkout']", cart: ".wp-block-woocommerce-cart[data-block-name='woocommerce/cart']", filterPrice: { class: { wrapper: ".wp-block-woocommerce-price-filter", controls: ".wc-block-price-filter__controls", filterSlideInput: '.wp-block-woocommerce-filter-wrapper[data-filter-type="price-filter"] .wc-block-price-slider input', minPriceWrapper: ".wc-block-price-filter__range-input--min", maxPriceWrapper: ".wc-block-price-filter__range-input--max", minPriceInput: "input.wc-block-price-filter__amount--min", maxPriceInput: "input.wc-block-price-filter__amount--max", resetButton: ".wc-block-components-filter-reset-button", progressRange: ".wc-block-price-filter__range-input-progress" } } }, cookies_data_args: { cartBlocks: "yay_cart_blocks_page", checkoutBlocks: "yay_checkout_blocks_page" } }, YayCurrency_Callback.Helper = { setCookie: function (e, r, t) { var c = ""; if (t) { var a = new Date; a.setTime(a.getTime() + 864e5 * t), c = "; expires=" + a.toUTCString() } document.cookie = e + "=" + (r || "") + c + "; path=/" }, getCookie: function (e) { let r = e + "=", t = decodeURIComponent(document.cookie).split(";"); for (let c = 0; c < t.length; c++) { let a = t[c]; for (; " " == a.charAt(0);)a = a.substring(1); if (0 == a.indexOf(r)) return a.substring(r.length, a.length) } return "" }, deleteCookie: function (e) { YayCurrency_Callback.Helper.setCookie(e, "", -1) }, getCurrentCurrency: function (e = !1) { e = e || YayCurrency_Callback.Helper.getCookie(r.yayCurrency.cookie_name); let t = !1; return r.yayCurrency.converted_currency && r.yayCurrency.converted_currency.forEach(r => { r.ID === +e && (t = r) }), t }, getRateFeeByCurrency: function (e = !1) { let r = parseFloat((e = e || YayCurrency_Callback.Helper.getCurrentCurrency()).rate); return "percentage" === e.fee.type ? parseFloat(e.rate) + parseFloat(e.rate) * (parseFloat(e.fee.value) / 100) : parseFloat(e.rate) + parseFloat(e.fee.value) }, getBlockData: function () { let r = {}; if (e(yay_currency_data_args.common_data_args.yayCurrencyBlock).length) { let t = e(yay_currency_data_args.common_data_args.yayCurrencyBlock); r.isShowFlag = t.data("show-flag"), r.isShowCurrencyName = t.data("show-currency-name"), r.isShowCurrencySymbol = t.data("show-currency-symbol"), r.isShowCurrencyCode = t.data("show-currency-code"), r.widgetSize = t.data("switcher-size") } return r }, blockLoading: function (r) { e(r).addClass("processing").block({ message: null, overlayCSS: { background: "#fff", opacity: .6 } }) }, unBlockLoading: function (r) { e(r).removeClass("processing").unblock() }, switcherUpwards: function () { let t = e(yay_currency_data_args.common_data_args.yayCurrencySwitcher); t.each(function () { let t = e(this).offset().top + e(this).height() - e(r).scrollTop(), c = e(r).height() - e(this).height() - e(this).offset().top + e(r).scrollTop(); c < 250 && t > 250 ? (e(this).find(yay_currency_data_args.switcher_data_args.customOption).addClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.customArrow).addClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.selectTrigger).addClass(yay_currency_data_args.switcher_data_args.upwardsClass)) : (e(this).find(yay_currency_data_args.switcher_data_args.customOption).removeClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.customArrow).removeClass(yay_currency_data_args.switcher_data_args.upwardsClass), e(this).find(yay_currency_data_args.switcher_data_args.selectTrigger).removeClass(yay_currency_data_args.switcher_data_args.upwardsClass)) }) }, switcherAction: function () { let t = yay_currency_data_args.switcher_data_args; e(document).on("click", t.selectWrapper, function () { e(t.customSelect, this).toggleClass(t.openClass), e("#slide-out-widget-area").find(t.customOption).toggleClass("overflow-fix"), e("[id^=footer]").toggleClass("z-index-fix"), e(t.customSelect, this).parents(".handheld-navigation").toggleClass("overflow-fix") }), e(document).on("click", t.customOptionArrow, function () { let r = e(this).data("value") ? e(this).data("value") : e(this).data("currency-id"), c = e(this).children(t.currencyFlag).data("country_code"); if (YayCurrency_Callback.Helper.refreshCartFragments(), e(t.currencySwitcher).val(r).change(), YayCurrency_Callback.Helper.setCookie(yayCurrency.cookie_switcher_name ?? "yay_currency_do_change_switcher", r, 1), !e(this).hasClass(t.selectedClass)) { let a = e(this).closest(t.customSelect); e(this).parent().find(t.customOptionArrowSelected).removeClass(t.selectedClass), e(this).addClass(t.selectedClass), a.find(t.currencySelectedFlag).css({ background: `url(${yayCurrency.yayCurrencyPluginURL}assets/dist/flags/${c}.svg)` }), a.find(t.selectedOption).text(e(this).text()), a.find(t.customLoader).addClass(t.activeClass), a.find(t.customArrow).hide() } }), r.addEventListener("click", function (e) { let r = document.querySelectorAll(yay_currency_data_args.switcher_data_args.customSelect); r.forEach(r => { r.contains(e.target) || r.classList.remove(yay_currency_data_args.switcher_data_args.openClass) }) }) }, refreshCartFragments: function () { "undefined" != typeof wc_cart_fragments_params && null !== wc_cart_fragments_params && sessionStorage.removeItem(wc_cart_fragments_params.fragment_name) }, detectCheckoutBlocks: function () { return !!e(yay_currency_data_args.blocks_data_args.checkout).length }, detectCartBlocks: function () { return !!e(yay_currency_data_args.blocks_data_args.cart).length }, reCalculateCartSubtotalCheckoutBlocksPage: function () { let r = yay_currency_data_args.cookies_data_args.checkoutBlocks; if (YayCurrency_Callback.Helper.deleteCookie(r), YayCurrency_Callback.Helper.detectCheckoutBlocks() && (YayCurrency_Callback.Helper.setCookie(r, "yes", 1), yayCurrency.checkout_notice_html)) { "" != yayCurrency.checkout_notice_html && e(yay_currency_data_args.blocks_data_args.checkout).before(yayCurrency.checkout_notice_html); let t = yay_currency_data_args.common_data_args.yayCurrencyCartContents; e(document.body).on("wc_fragments_refreshed", function () { e.ajax({ url: yayCurrency.ajaxurl, type: "POST", data: { action: "yayCurrency_get_cart_subtotal_default_blocks", nonce: yayCurrency.nonce }, beforeSend: function (e) { YayCurrency_Callback.Helper.blockLoading(t) }, xhrFields: { withCredentials: !0 }, success: function r(c) { YayCurrency_Callback.Helper.unBlockLoading(t), c.success && c.data.cart_subtotal && e(t).find(".woocommerce-Price-amount.amount").html(c.data.cart_subtotal) }, error: function (e, r, c) { YayCurrency_Callback.Helper.unBlockLoading(t), console.log("Error responseText: ", e.responseText) } }) }) } }, getCurrentCurrencyByCode: function (e = !1, t = !1) { e = e || r.yayCurrency.default_currency_code; let c = !1; return (t = t || r.yayCurrency.converted_currency) && t.forEach(r => { r.currency === e && (c = r) }), c }, currencyConverter: function () { let r = yay_currency_data_args.converter_args.converterWrapper; e(r).length && e(r).each(function (r, t) { YayCurrency_Callback.Helper.doConverterCurrency(e(t)) }) }, doFormatNumber: function (e, r, t, c, a = !1) { var o, n; if ("N/A" === e || "" === e) return e; let i = isFinite(+(e = (e + "").replace(/[^0-9+\-Ee.]/g, ""))) ? +e : 0, l = isFinite(+r) ? Math.abs(r) : 0, s = void 0 === t ? "." : t, u = "", p; return (u = (l ? (o = i, "" + Math.round(o * (p = Math.pow(10, n = l))) / p) : "" + Math.round(i)).split("."))[0].length > 3 && (u[0] = u[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, void 0 === c ? "," : c)), (u[1] || "").length < l && (u[1] = u[1] || "", u[1] += Array(l - u[1].length + 1).join("0")), a ? u.join(s) : u.join(s).replace(/([0-9]*\.0*[1-9]+)0+$/gm, "$1").replace(/.00+$/, "") }, roundedAmountByCurrency: function (e, r) { if (!r) return e; let { numberDecimal: t, decimalSeparator: c, thousandSeparator: a } = r; e = YayCurrency_Callback.Helper.handelRoundedPriceByCurrency(e, r); let o = YayCurrency_Callback.Helper.doFormatNumber(e, Number(t), c, a, !0); return o }, doApplyResultConverter: function (r, t) { let c = r.find(yay_currency_data_args.converter_args.converterFrom), a = r.find(yay_currency_data_args.converter_args.converterTo), o = t.from_currency_code ? t.from_currency_code : e(c).val(), n = t.to_currency_code ? t.to_currency_code : e(a).val(), i = t.amount_value ? +t.amount_value : +e(r.find(yay_currency_data_args.converter_args.converterAmount)).val(); if (n === o) e(r.find(yay_currency_data_args.converter_args.converterResultValue)).text(i); else { let l = YayCurrency_Callback.Helper.getCurrentCurrencyByCode(o), s = YayCurrency_Callback.Helper.getCurrentCurrencyByCode(n), u = YayCurrency_Callback.Helper.getRateFeeByCurrency(s); if (l && o !== yayCurrency.default_currency_code) { let p = YayCurrency_Callback.Helper.getRateFeeByCurrency(l); i *= parseFloat(1 / p) } e(r.find(yay_currency_data_args.converter_args.converterResultValue)).text(YayCurrency_Callback.Helper.roundedAmountByCurrency(i * u, s)) } }, doConverterCurrency: function (r) { let t = r.find(yay_currency_data_args.converter_args.converterAmount), c = r.find(yay_currency_data_args.converter_args.converterFrom), a = r.find(yay_currency_data_args.converter_args.converterTo), o = r.find(yay_currency_data_args.converter_args.converterResultWrapper); e(c).change(function () { e(r.find(yay_currency_data_args.converter_args.converterResultFrom)).text(e(this).val()), YayCurrency_Callback.Helper.doApplyResultConverter(r, { from_currency_code: e(this).val() }) }), e(a).change(function () { e(r.find(yay_currency_data_args.converter_args.converterResultTo)).text(e(this).val()), YayCurrency_Callback.Helper.doApplyResultConverter(r, { to_currency_code: e(this).val() }) }), e(t).on("input", function () { let t = e(this).val(); e(this).val(t.replace(/\D/g, "")), t ? (e(o).show(), e(r.find(yay_currency_data_args.converter_args.converterResultAmount)).text(t), YayCurrency_Callback.Helper.doApplyResultConverter(r, { amount_value: t })) : e(o).hide() }), e(t).trigger("input"), e(c).trigger("change"), e(a).trigger("change") }, handelRoundedPriceByCurrency: function (e, r) { let { roundingType: t, roundingValue: c, subtractAmount: a } = r; switch (t) { case "up": e = Math.ceil(e / c) * c - a; break; case "down": e = Math.floor(e / c) * c - a; break; case "nearest": e = Math.round(e / c) * c - a }return e }, handelConvertPrice: function (e, r, t = !1) { let c = YayCurrency_Callback.Helper.getCurrentCurrency(r), a = parseFloat(YayCurrency_Callback.Helper.getRateFeeByCurrency(c)); return a && 1 !== a ? (e *= a, t && (e = parseInt(e) / t), e = YayCurrency_Callback.Helper.handelRoundedPriceByCurrency(e, c), t ? e * t : e) : e }, handelRevertPrice: function (e = 0, r = !1) { if (!r) { let t = YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name); r = YayCurrency_Callback.Helper.getCurrentCurrency(t) } let c = parseFloat(YayCurrency_Callback.Helper.getRateFeeByCurrency(r)); return c && 1 !== c ? e / c : e }, decodeHtmlEntity: function (e) { var r = document.createElement("textarea"); return r.innerHTML = e, r.value }, formatPricePosition: function (e = 0, r = "", t = "left") { let c = e; switch (t) { case "left": c = r + c; break; case "right": c += r; break; case "left_space": c = r + " " + c; break; case "right_space": c = c + " " + r }return c }, formatPriceByCurrency: function (e = 0, r = !1, t = !1) { if (!t) { let c = YayCurrency_Callback.Helper.getCookie(yayCurrency.cookie_name); t = YayCurrency_Callback.Helper.getCurrentCurrency(c) } if (r) { let a = parseFloat(YayCurrency_Callback.Helper.getRateFeeByCurrency(t)); e = YayCurrency_Callback.Helper.handelRoundedPriceByCurrency(e * a, t) } var o = e.toFixed(t.numberDecimal).split("."); o[0] = o[0].replace(/\B(?=(\d{3})+(?!\d))/g, t.thousandSeparator); var n = o.join(t.decimalSeparator), i = YayCurrency_Callback.Helper.decodeHtmlEntity(t.symbol); return YayCurrency_Callback.Helper.formatPricePosition(n, i, t.currencyPosition) }, compatibleWithThirdPartyPlugins: function (t) { if (r.wc_price_calculator_params) { let c = YayCurrency_Callback.Helper.getCurrentCurrency(t), a = YayCurrency_Callback.Helper.getRateFeeByCurrency(c); r.wc_price_calculator_params.woocommerce_currency_pos = c.currencyPosition, r.wc_price_calculator_params.woocommerce_price_decimal_sep = c.decimalSeparator, r.wc_price_calculator_params.woocommerce_price_num_decimals = c.numberDecimal, r.wc_price_calculator_params.woocommerce_price_thousand_sep = c.thousandSeparator, r.wc_price_calculator_params.pricing_rules && r.wc_price_calculator_params.pricing_rules.forEach(e => { e.price = (parseFloat(e.price) * a).toString(), e.regular_price = (parseFloat(e.regular_price) * a).toString(), e.sale_price = (parseFloat(e.sale_price) * a).toString() }) } if (r.yayCurrency.ppc_paypal) { yayCurrency.checkout_diff_currency && "1" === yayCurrency.checkout_diff_currency && jQuery(document).ready(function (e) { yayCurrency.checkout_page && "1" === yayCurrency.checkout_page || e(document.body).trigger("wc_fragment_refresh") }); let o = (e, r) => { r ? YayCurrency_Callback.Helper.setCookie(e, "yes", +yayCurrency.cookie_lifetime_days) : YayCurrency_Callback.Helper.getCookie(e) && YayCurrency_Callback.Helper.deleteCookie(e) }, n = () => { o("ppc_paypal_cart_or_product_page", "1" === yayCurrency.cart_page || "1" === yayCurrency.product_page), o("ppc_paypal_checkout_page", yayCurrency.checkout_page && "1" === yayCurrency.checkout_page) }; n(), e(document).on("visibilitychange", function () { "visible" === document.visibilityState && n() }) } YayCurrency_Callback.Helper.handleFilterByPrice(t) }, handleFilterByPrice: function (e) { r.onload = function () { YayCurrency_Callback.Helper.handleFilterByPriceClassicEditor(e), YayCurrency_Callback.Helper.handleFilterByPriceBlock(e) } }, priceSliderAmountFormatMoney: function (e, r, t) { e.html(accounting.formatMoney(r, { symbol: t.currency_format_symbol, decimal: t.currency_format_decimal_sep, thousand: t.currency_format_thousand_sep, precision: t.currency_format_num_decimals, format: t.currency_format })) }, handleFilterByPriceClassicEditor: function (t) { if (e(".widget_price_filter .price_slider").length) { let c = YayCurrency_Callback.Helper.getCurrentCurrency(t); if (c.currency === r.yayCurrency.default_currency_code) return; let a = e(".price_slider_amount #min_price").val(), o = e(".price_slider_amount #max_price").val(); a && o && (e(document.body).on("price_slider_create price_slider_slide", function (r, t, a) { e(".price_slider_amount span.from").html(YayCurrency_Callback.Helper.formatPriceByCurrency(t, !0, c)), e(".price_slider_amount span.to").html(YayCurrency_Callback.Helper.formatPriceByCurrency(a, !0, c)) }), e(".price_slider_amount span.from").html(YayCurrency_Callback.Helper.formatPriceByCurrency(a, !0, c)), e(".price_slider_amount span.to").html(YayCurrency_Callback.Helper.formatPriceByCurrency(o, !0, c))) } }, handleFilterByPriceBlock: function (t) { if (!r.wc || !r.wc.priceFormat) return; let c = e(yay_currency_data_args.blocks_data_args.filterPrice.class.wrapper), a = r.wc.priceFormat.getCurrency() ? 10 ** r.wc.priceFormat.getCurrency().minorUnit : 1; if (c.length && c.find(yay_currency_data_args.blocks_data_args.filterPrice.class.controls).length) { let o = 1, n = !1, i = setInterval(function () { let r = e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceWrapper), t = e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceWrapper); if (r.length && t.length) { let c = e(yay_currency_data_args.blocks_data_args.filterPrice.class.filterSlideInput).parents(yay_currency_data_args.blocks_data_args.filterPrice.class.controls), a = c.clone(); c.replaceWith(a); let l = !!r.attr("aria-valuetext") && +r.attr("aria-valuetext"); l && (e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceInput).val(YayCurrency_Callback.Helper.formatPriceByCurrency(l, !0)), e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceInput).css("pointer-events", "none")); let s = !!t.attr("aria-valuetext") && +t.attr("aria-valuetext"); s && (e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceInput).val(YayCurrency_Callback.Helper.formatPriceByCurrency(s, !0)), e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceInput).css("pointer-events", "none")), n = !0 } (5 === o || n) && clearInterval(i), ++o }, 500) } e(document).on("input", yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceWrapper, function () { let r = !!e(this).attr("aria-valuetext") && +e(this).attr("aria-valuetext"); r && e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceInput).val(YayCurrency_Callback.Helper.formatPriceByCurrency(r, !0)) }), e(document).on("input", yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceWrapper, function () { let r = !!e(this).attr("aria-valuetext") && +e(this).attr("aria-valuetext"); r && e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceInput).val(YayCurrency_Callback.Helper.formatPriceByCurrency(r, !0)) }), e(document).on("click", yay_currency_data_args.blocks_data_args.filterPrice.class.resetButton, function () { let c = e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceWrapper).attr("min"), o = e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceWrapper).attr("max"); c && o && (c = YayCurrency_Callback.Helper.handelConvertPrice(c, t, a), o = YayCurrency_Callback.Helper.handelConvertPrice(o, t, a), e(yay_currency_data_args.blocks_data_args.filterPrice.class.minPriceInput).val(r.wc.priceFormat.formatPrice(c)), e(yay_currency_data_args.blocks_data_args.filterPrice.class.maxPriceInput).val(r.wc.priceFormat.formatPrice(o))) }) } } }(jQuery, window);